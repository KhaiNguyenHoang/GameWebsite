# Cáº¥u TrÃºc ThÆ° Má»¥c BackEnd - Giáº£i ThÃ­ch Chá»©c NÄƒng

## Tá»•ng Quan
ThÆ° má»¥c BackEnd chá»©a toÃ n bá»™ mÃ£ nguá»“n cho pháº§n backend cá»§a dá»± Ã¡n GameWebsite sá»­ dá»¥ng ASP.NET Core. Cáº¥u trÃºc Ä‘Æ°á»£c tá»• chá»©c theo cÃ¡c tiÃªu chuáº©n phÃ¡t triá»ƒn pháº§n má»m chuyÃªn nghiá»‡p, phÃ¢n tÃ¡ch rÃµ rÃ ng cÃ¡c lá»›p logic, dá»¯ liá»‡u vÃ  dá»‹ch vá»¥.

## Cáº¥u TrÃºc ThÆ° Má»¥c ChÃ­nh

### ğŸ“ BackEnd (ThÆ° má»¥c gá»‘c)
- Chá»©a toÃ n bá»™ mÃ£ nguá»“n backend.
- File chÃ­nh: `Program.cs` (Ä‘iá»ƒm khá»Ÿi cháº¡y á»©ng dá»¥ng), `BackEnd.csproj` (cáº¥u hÃ¬nh dá»± Ã¡n).

### ğŸ“ Controllers
- Chá»©a cÃ¡c API controllers xá»­ lÃ½ cÃ¡c yÃªu cáº§u HTTP tá»« frontend.
- Má»—i controller quáº£n lÃ½ má»™t module cá»¥ thá»ƒ (vÃ­ dá»¥: AuthController cho xÃ¡c thá»±c, GameController cho logic game).
- Chá»©c nÄƒng: Nháº­n request, gá»i services, tráº£ vá» response JSON.

### ğŸ“ Services
- Chá»©a cÃ¡c lá»›p service thá»±c hiá»‡n business logic chÃ­nh.
- TÃ¡ch biá»‡t logic nghiá»‡p vá»¥ khá»i controllers Ä‘á»ƒ dá»… test vÃ  maintain.
- VÃ­ dá»¥: UserService (quáº£n lÃ½ ngÆ°á»i dÃ¹ng), GameService (logic trÃ² chÆ¡i), NotificationService (thÃ´ng bÃ¡o).

### ğŸ“ Repositories
- Chá»©a cÃ¡c lá»›p repository xá»­ lÃ½ truy cáº­p dá»¯ liá»‡u (Data Access Layer).
- Sá»­ dá»¥ng Entity Framework Core Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i database.
- VÃ­ dá»¥: UserRepository (CRUD operations cho users), GameRepository (lÆ°u trá»¯ dá»¯ liá»‡u game).

### ğŸ“ Models
- Chá»©a cÃ¡c entity classes Ä‘áº¡i diá»‡n cho dá»¯ liá»‡u trong database.
- Äá»‹nh nghÄ©a schema cho cÃ¡c báº£ng (Account, Role, Permission, IDCard).
- Sá»­ dá»¥ng Data Annotations cho validation vÃ  mapping EF Core.

### ğŸ“ DTOs
- Data Transfer Objects: CÃ¡c lá»›p dÃ¹ng Ä‘á»ƒ truyá»n dá»¯ liá»‡u giá»¯a cÃ¡c layer.
- Bao gá»“m ApiResponseSuccess, ApiResponseFailed, ApiResponseCode cho chuáº©n hÃ³a response API.
- GiÃºp tÃ¡ch biá»‡t internal models khá»i public API.

### ğŸ“ Utils
- Chá»©a cÃ¡c utility classes vÃ  helper functions.
- DatabaseContext.cs: DbContext cho Entity Framework.
- CÃ¡c hÃ m há»— trá»£ chung nhÆ° validation, encryption, logging.

### ğŸ“ CustomValidations
- Chá»©a cÃ¡c custom validation attributes cho model validation.
- VÃ­ dá»¥: IdentifyDateValidationAttribute (kiá»ƒm tra ngÃ y thÃ¡ng CMND), NumberIDCardValidate (kiá»ƒm tra sá»‘ CMND).
- TÃ­ch há»£p vá»›i ASP.NET Core validation pipeline.

### ğŸ“ Middleware
- Chá»©a cÃ¡c custom middleware xá»­ lÃ½ request/response pipeline.
- VÃ­ dá»¥: AuthenticationMiddleware, ErrorHandlingMiddleware, CORS middleware.
- Cháº¡y trÆ°á»›c/ sau controllers Ä‘á»ƒ xá»­ lÃ½ cross-cutting concerns.

### ğŸ“ Extensions
- Chá»©a cÃ¡c extension methods cho cÃ¡c .NET classes.
- VÃ­ dá»¥: StringExtensions (hÃ m má»Ÿ rá»™ng cho string), ServiceCollectionExtensions (Ä‘Äƒng kÃ½ DI).
- GiÃºp code sáº¡ch vÃ  tÃ¡i sá»­ dá»¥ng.

### ğŸ“ Configurations
- Chá»©a cÃ¡c lá»›p configuration cho á»©ng dá»¥ng.
- VÃ­ dá»¥: AppSettings, DatabaseConfig, JWTConfig.
- Äá»c tá»« appsettings.json vÃ  cung cáº¥p cho DI container.

### ğŸ“ Migrations
- Chá»©a cÃ¡c migration files cá»§a Entity Framework Core.
- Tá»± Ä‘á»™ng táº¡o khi cháº¡y `dotnet ef migrations add`.
- Quáº£n lÃ½ schema database changes.

### ğŸ“ wwwroot
- ThÆ° má»¥c static files (CSS, JS, images) phá»¥c vá»¥ trá»±c tiáº¿p qua web server.
- Sá»­ dá»¥ng cho API documentation (Swagger UI), favicon, hoáº·c static assets.

### ğŸ“ Tests
- Chá»©a toÃ n bá»™ test cases cho backend.

  #### ğŸ“ UnitTests
  - Test Ä‘Æ¡n vá»‹ cho tá»«ng method/function.
  - Sá»­ dá»¥ng xUnit/NUnit, Moq cho mocking.
  - Test business logic trong services vÃ  utilities.

  #### ğŸ“ IntegrationTests
  - Test tÃ­ch há»£p giá»¯a cÃ¡c components (API endpoints, database).
  - Sá»­ dá»¥ng TestServer cho ASP.NET Core, InMemoryDatabase.
  - Äáº£m báº£o toÃ n bá»™ flow hoáº¡t Ä‘á»™ng Ä‘Ãºng.

### ğŸ“ Properties
- Chá»©a file launchSettings.json (cáº¥u hÃ¬nh debug profiles).
- CÃ i Ä‘áº·t environment variables, ports cho development.

## CÃ¡c File Cáº¥u HÃ¬nh ChÃ­nh
- `appsettings.json`: Cáº¥u hÃ¬nh chung (ConnectionString, Logging, JWT).
- `appsettings.Development.json`: Cáº¥u hÃ¬nh cho mÃ´i trÆ°á»ng development.
- `BackEnd.http`: File REST Client cho testing API trong VS Code.

## HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng
1. Cháº¡y migrations: `dotnet ef database update`
2. Khá»Ÿi Ä‘á»™ng: `dotnet run`
3. Test API: Sá»­ dá»¥ng Swagger táº¡i `/swagger` hoáº·c Postman.
4. Cháº¡y tests: `dotnet test`

Cáº¥u trÃºc nÃ y há»— trá»£ phÃ¡t triá»ƒn scalable, maintainable cho dá»± Ã¡n game website lá»›n, vá»›i separation of concerns rÃµ rÃ ng.

